CREATE TABLE REVIEW 
    ( 
     STORE_ID  VARCHAR2 (20 CHAR)  NOT NULL , 
     USER_ID   VARCHAR2 (15 CHAR)  NOT NULL , 
     "COMENT" VARCHAR2 (50 CHAR) , 
     RATIO     INTEGER  NOT NULL , 
     REVIEW_ID INTEGER  NOT NULL 
    ) 
;

ALTER TABLE REVIEW 
    ADD 
    CHECK (RATIO BETWEEN 1 AND 10) 
;

ALTER TABLE REVIEW 
    ADD CONSTRAINT REVIEW_PK PRIMARY KEY ( REVIEW_ID ) ;

ALTER TABLE REVIEW 
    ADD CONSTRAINT REVIEW__UN UNIQUE ( USER_ID, STORE_ID ) ;

CREATE SEQUENCE REVIEW_REVIEW_ID_SEQ 
START WITH 1 
    NOCACHE 
    ORDER ;

CREATE OR REPLACE TRIGGER REVIEW_REVIEW_ID_TRG 
BEFORE INSERT ON REVIEW 
FOR EACH ROW 
WHEN (NEW.REVIEW_ID IS NULL) 
BEGIN 
    :NEW.REVIEW_ID := REVIEW_REVIEW_ID_SEQ.NEXTVAL; 
END;
/



