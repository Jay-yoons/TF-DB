1. 백업 목적과 중요성
  백업의 목적: 데이터 파일 컨트롤파일 리두 파일이 정합성 디스크 이상이 발생하면, 서비스 자체가 문제가 발생하게 된다.
  이에 백업을 통해 해당 장애의 문제점 해결하고자 한다.

2. 백업 정책 개요 (주기, 보관 기간 등)
  주기 매일 백업을 진행한다. 보관 기간의 경우 3개월로 통해 확인한다.

3. 백업 종류 (전체, 증분, 차등 등)
  일 월 화 수 목 금 토
  0  3  3c 2  3  3c 1

  일요일(0): 레벨 0 전체 백업
  월요일(3): 증분 백업 (레벨 3 - 보통 RMAN에서 공식 레벨은 0과 1이지만, 내부적으로 레벨 세분화하는 경우가 있음)
  화요일(3c): 증분 누적 백업 (cumulative incremental)
  수요일(2): 차등 백업 (레벨 2)
  목요일(3): 증분 백업
  금요일(3c): 증분 누적 백업
  토요일(1): 증분 백업 (레벨 1)
  
  백업의 형태는 위 내용과 같으며

  0: LEVEL 0 전체 백업을 의미하며
  3: 추가 데이터의 증분 백업
  3c: 이전 3의 데이터의 추가 된것을 백업
  2: 차등 백업 백업 상에서 다른 내용들을 백업
  1: 증분 백업


4. 백업 방법 (RMAN 스크립트, 명령어 등 구체적 절차)
  추후 작성 예정

5. 복구 시나리오 (실제 상황별 복구 절차)
  Primary DB DOWN: DATA가드가 이를 확인하여 자동 Failover
  StandBY DB DOWN: STARTUP
  Primary DB 네트워크 간혈적 통신 이상 발생: AWS 스크립트로 네트워크 상태 점검 후 필요 시 Failover 진행
  
6. 검증 및 테스트 (백업 검증, 복구 테스트 결과)
  추후 테스트

7. 백업 저장 위치 및 보안
  백업 파일은 개인 외장 하드 및 클라우드 저장소에 분산 보관 (하이브리드 아키텍처)
  저장 위치별 권한 관리 및 암호화 적용 권장
  전송 시 네트워크 보안(예: VPN, SSL) 적용 필요


아래)
스크립트

#!/bin/bash
export ORACLE_HOME=/u01/app/oracle/product/19.0.0/dbhome_1
export ORACLE_SID=ORCL
export PATH=$ORACLE_HOME/bin:$PATH

DAY=$(date +%a)   # 요일 추출 (Sun, Mon, Tue...)

LOGDIR=/backup/log
mkdir -p $LOGDIR

case $DAY in
  Sun) SCRIPT=/backup/rman_backup_sun.rman ;;
  Mon) SCRIPT=/backup/rman_backup_mon.rman ;;
  Tue) SCRIPT=/backup/rman_backup_tue.rman ;;
  Wed) SCRIPT=/backup/rman_backup_wed.rman ;;
  Thu) SCRIPT=/backup/rman_backup_thu.rman ;;
  Fri) SCRIPT=/backup/rman_backup_fri.rman ;;
  Sat) SCRIPT=/backup/rman_backup_sat.rman ;;
esac

rman target / cmdfile=$SCRIPT log=$LOGDIR/rman_${DAY}.log




일요일 (레벨 0 풀백업)
BACKUP INCREMENTAL LEVEL 0 DATABASE TAG 'FULL_SUNDAY';

RUN {
  CONFIGURE CONTROLFILE AUTOBACKUP ON;
  BACKUP INCREMENTAL LEVEL 0 DATABASE PLUS ARCHIVELOG TAG 'FULL_SUN'
    FORMAT '/backup/rman/full_sun_%U.bkp';
}


월요일 (레벨 1 차등 증분 백업)
BACKUP INCREMENTAL LEVEL 1 DATABASE TAG 'DIFF_MON';
RUN {
  BACKUP INCREMENTAL LEVEL 1 DATABASE PLUS ARCHIVELOG TAG 'DIFF_MON'
    FORMAT '/backup/rman/diff_mon_%U.bkp';
}




화요일 (레벨 1 누적 증분 백업)
BACKUP INCREMENTAL LEVEL 1 CUMULATIVE DATABASE TAG 'CUM_TUE';

RUN {
  BACKUP INCREMENTAL LEVEL 1 CUMULATIVE DATABASE PLUS ARCHIVELOG TAG 'CUM_TUE'
    FORMAT '/backup/rman/cum_tue_%U.bkp';
}


수요일 (레벨 1 차등 증분 백업)
BACKUP INCREMENTAL LEVEL 1 DATABASE TAG 'DIFF_WED';

BACKUP INCREMENTAL LEVEL 1 DATABASE TAG 'DIFF_WED';
RUN {
  BACKUP INCREMENTAL LEVEL 1 DATABASE PLUS ARCHIVELOG TAG 'DIFF_WED'
    FORMAT '/backup/rman/diff_wed_%U.bkp';
}


목요일 (레벨 1 차등 증분 백업)
BACKUP INCREMENTAL LEVEL 1 DATABASE TAG 'DIFF_THU';

RUN {
  BACKUP INCREMENTAL LEVEL 1 DATABASE PLUS ARCHIVELOG TAG 'DIFF_THU'
    FORMAT '/backup/rman/diff_THU_%U.bkp';
}

금요일 (레벨 1 누적 증분 백업)
BACKUP INCREMENTAL LEVEL 1 CUMULATIVE DATABASE TAG 'CUM_FRI';

RUN {
  BACKUP INCREMENTAL LEVEL 1 DATABASE PLUS ARCHIVELOG TAG 'CUM_FRI'
    FORMAT '/backup/rman/cum_fri_%U.bkp';
}


토요일 (레벨 1 차등 증분 백업)
BACKUP INCREMENTAL LEVEL 1 DATABASE TAG 'DIFF_SAT';

RUN {
  BACKUP INCREMENTAL LEVEL 1 DATABASE PLUS ARCHIVELOG TAG 'DIFF_SAT'
    FORMAT '/backup/rman/diff_sat_%U.bkp';
}
-----------------------------------------------------------------

CRON
0 2 * * * /backup/run_rman.sh


