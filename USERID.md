CREATE TABLE USERS 
    ( 
     USER_ID      VARCHAR2 (15 CHAR)  NOT NULL , 
     USER_NAME    VARCHAR2 (20 CHAR)  NOT NULL , 
     USER_LOCATION     VARCHAR2 (50 CHAR) , 
     PHONE_NUMBER VARCHAR2 (20 CHAR)  NOT NULL 
    ) 
;

ALTER TABLE USERS 
    ADD CONSTRAINT USERS_PK PRIMARY KEY ( USER_ID ) ;

-------------------------------------------------------------------------

CREATE TABLE FAV_STORE 
    ( 
     STORE_ID     VARCHAR2 (20 CHAR)  NOT NULL , 
     USER_ID      VARCHAR2 (15)  NOT NULL , 
     FAV_STORE_ID INTEGER  NOT NULL 
    ) 
;

ALTER TABLE FAV_STORE 
    ADD CONSTRAINT TABLE_3_PK PRIMARY KEY ( FAV_STORE_ID ) ;

ALTER TABLE FAV_STORE 
    ADD CONSTRAINT TABLE_3__UN UNIQUE ( USER_ID , STORE_ID ) ;

ALTER TABLE FAV_STORE 
    ADD CONSTRAINT TABLE_3_USERS_FK FOREIGN KEY 
    ( 
     USER_ID
    ) 
    REFERENCES USERS 
    ( 
     USER_ID
    ) 
;

CREATE SEQUENCE FAV_STORE_FAV_STORE_ID_SEQ 
START WITH 1 
    NOCACHE 
    ORDER ;

CREATE OR REPLACE TRIGGER FAV_STORE_FAV_STORE_ID_TRG 
BEFORE INSERT ON FAV_STORE 
FOR EACH ROW 
WHEN (NEW.FAV_STORE_ID IS NULL) 
BEGIN 
    :NEW.FAV_STORE_ID := FAV_STORE_FAV_STORE_ID_SEQ.NEXTVAL; 
END;
/



