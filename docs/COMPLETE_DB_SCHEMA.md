# ðŸ—„ï¸ Team-FOG ì „ì²´ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

## ðŸ“‹ ê°œìš”

ì´ ë¬¸ì„œëŠ” Team-FOG í”„ë¡œì íŠ¸ì˜ ì „ì²´ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
ëª¨ë“  í…Œì´ë¸”ì€ Oracle PDB (Pluggable Database) í™˜ê²½ì—ì„œ ìš´ì˜ë©ë‹ˆë‹¤.

## ðŸ—ï¸ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°

### Container Database (CDB)
- **CDB Name**: ORCL
- **PDB Name**: TEAMFOG

### ì„œë¹„ìŠ¤ë³„ ìŠ¤í‚¤ë§ˆ ë¶„ë¦¬
- **User Service**: user_service ìŠ¤í‚¤ë§ˆ
- **Store Service**: store_service ìŠ¤í‚¤ë§ˆ  
- **Reservation Service**: reservation_service ìŠ¤í‚¤ë§ˆ

## ðŸ“Š í…Œì´ë¸” ì •ì˜

### 1. USERS í…Œì´ë¸” (User Service)
```sql
CREATE TABLE USERS (
    USER_ID VARCHAR2(15) PRIMARY KEY,
    USER_NAME VARCHAR2(20) NOT NULL,
    PHONE_NUMBER VARCHAR2(20) UNIQUE NOT NULL,
    USER_LOCATION VARCHAR2(50),
    PASSWORD VARCHAR2(255) NOT NULL,
    IS_ACTIVE NUMBER(1) DEFAULT 1 NOT NULL,
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP NOT NULL,
    UPDATED_AT TIMESTAMP
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_users_phone ON USERS(PHONE_NUMBER);
```

### 2. FAV_STORE í…Œì´ë¸” (User Service)
```sql
CREATE TABLE FAV_STORE (
    FAV_STORE_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    USER_ID VARCHAR2(15) NOT NULL,
    STORE_ID2 VARCHAR2(20) NOT NULL,
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP NOT NULL,
    CONSTRAINT fav_store_un UNIQUE (USER_ID, STORE_ID2)
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_fav_store_user ON FAV_STORE(USER_ID);
CREATE INDEX idx_fav_store_store ON FAV_STORE(STORE_ID2);
```

### 3. STORES í…Œì´ë¸” (Store Service)
```sql
CREATE TABLE STORES (
    STORE_ID VARCHAR2(20) PRIMARY KEY,
    STORE_NAME VARCHAR2(100) NOT NULL,
    STORE_LOCATION VARCHAR2(200) NOT NULL,
    SERVICE_TIME VARCHAR2(100),
    CATEGORY_CODE VARCHAR2(10) NOT NULL,
    SEAT_NUM NUMBER NOT NULL
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_stores_category ON STORES(CATEGORY_CODE);
```

### 4. MENU í…Œì´ë¸” (Store Service)
```sql
CREATE TABLE MENU (
    STORE_ID VARCHAR2(20) NOT NULL,
    FIELD VARCHAR2(100) NOT NULL,
    PRICE NUMBER NOT NULL,
    CONSTRAINT pk_menu PRIMARY KEY (STORE_ID, FIELD)
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_menu_store ON MENU(STORE_ID);
```

### 5. BOOKING í…Œì´ë¸” (Reservation Service)
```sql
CREATE TABLE BOOKING (
    BOOKING_NUM VARCHAR2(20) PRIMARY KEY,
    BOOKING_DATE DATE NOT NULL,
    USER_ID VARCHAR2(15) NOT NULL,
    STORE_ID VARCHAR2(20) NOT NULL,
    BOOKING_STATE_CODE VARCHAR2(10) NOT NULL,
    COUNT NUMBER NOT NULL
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_booking_user ON BOOKING(USER_ID);
CREATE INDEX idx_booking_store ON BOOKING(STORE_ID);
CREATE INDEX idx_booking_date ON BOOKING(BOOKING_DATE);
```

### 6. STORE_SEAT í…Œì´ë¸” (Reservation Service)
```sql
CREATE TABLE STORE_SEAT (
    STORE_ID VARCHAR2(20) PRIMARY KEY,
    IN_USING_SEAT NUMBER NOT NULL
);
```

### 7. REVIEW í…Œì´ë¸” (Store Service)
```sql
CREATE TABLE REVIEW (
    REVIEW_ID VARCHAR2(20) PRIMARY KEY,
    STORE_ID VARCHAR2(20) NOT NULL,
    USER_ID VARCHAR2(15) NOT NULL,
    COMMENT CLOB,
    SCORE NUMBER(2,1) CHECK (SCORE >= 1 AND SCORE <= 10)
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_review_store ON REVIEW(STORE_ID);
CREATE INDEX idx_review_user ON REVIEW(USER_ID);
```

### 8. BOOKING_STATE_CODE í…Œì´ë¸” (Reservation Service)
```sql
CREATE TABLE BOOKING_STATE_CODE (
    BOOKING_STATE_CODE VARCHAR2(10) PRIMARY KEY,
    STATE_NAME VARCHAR2(50) NOT NULL
);

-- ê¸°ë³¸ ë°ì´í„°
INSERT INTO BOOKING_STATE_CODE VALUES ('RESERVED', 'ì˜ˆì•½');
INSERT INTO BOOKING_STATE_CODE VALUES ('IN_PROGRESS', 'ì˜ˆì•½ ì¤‘');
INSERT INTO BOOKING_STATE_CODE VALUES ('CANCELLED', 'ì˜ˆì•½ ì·¨ì†Œ');
```

### 9. CATEGORY í…Œì´ë¸” (Store Service)
```sql
CREATE TABLE CATEGORY (
    CATEGORY_CODE VARCHAR2(10) PRIMARY KEY,
    CATEGORY_NAME VARCHAR2(50) NOT NULL
);

-- ê¸°ë³¸ ë°ì´í„°
INSERT INTO CATEGORY VALUES ('KOREAN', 'í•œì‹');
INSERT INTO CATEGORY VALUES ('CHINESE', 'ì¤‘ì‹');
INSERT INTO CATEGORY VALUES ('JAPANESE', 'ì¼ì‹');
INSERT INTO CATEGORY VALUES ('WESTERN', 'ì–‘ì‹');
INSERT INTO CATEGORY VALUES ('CAFE', 'ì¹´íŽ˜');
```

## ðŸ”— ì™¸ëž˜í‚¤ ì œì•½ì¡°ê±´

```sql
-- FAV_STORE í…Œì´ë¸” ì™¸ëž˜í‚¤
ALTER TABLE FAV_STORE ADD CONSTRAINT fk_fav_store_user 
    FOREIGN KEY (USER_ID) REFERENCES USERS(USER_ID);

ALTER TABLE FAV_STORE ADD CONSTRAINT fk_fav_store_store 
    FOREIGN KEY (STORE_ID2) REFERENCES STORES(STORE_ID);

-- MENU í…Œì´ë¸” ì™¸ëž˜í‚¤
ALTER TABLE MENU ADD CONSTRAINT fk_menu_store 
    FOREIGN KEY (STORE_ID) REFERENCES STORES(STORE_ID);

-- BOOKING í…Œì´ë¸” ì™¸ëž˜í‚¤
ALTER TABLE BOOKING ADD CONSTRAINT fk_booking_user 
    FOREIGN KEY (USER_ID) REFERENCES USERS(USER_ID);

ALTER TABLE BOOKING ADD CONSTRAINT fk_booking_store 
    FOREIGN KEY (STORE_ID) REFERENCES STORES(STORE_ID);

ALTER TABLE BOOKING ADD CONSTRAINT fk_booking_state 
    FOREIGN KEY (BOOKING_STATE_CODE) REFERENCES BOOKING_STATE_CODE(BOOKING_STATE_CODE);

-- STORE_SEAT í…Œì´ë¸” ì™¸ëž˜í‚¤
ALTER TABLE STORE_SEAT ADD CONSTRAINT fk_store_seat_store 
    FOREIGN KEY (STORE_ID) REFERENCES STORES(STORE_ID);

-- REVIEW í…Œì´ë¸” ì™¸ëž˜í‚¤
ALTER TABLE REVIEW ADD CONSTRAINT fk_review_store 
    FOREIGN KEY (STORE_ID) REFERENCES STORES(STORE_ID);

ALTER TABLE REVIEW ADD CONSTRAINT fk_review_user 
    FOREIGN KEY (USER_ID) REFERENCES USERS(USER_ID);

-- STORES í…Œì´ë¸” ì™¸ëž˜í‚¤
ALTER TABLE STORES ADD CONSTRAINT fk_stores_category 
    FOREIGN KEY (CATEGORY_CODE) REFERENCES CATEGORY(CATEGORY_CODE);
```

## ðŸ“ ì„œë¹„ìŠ¤ë³„ í…Œì´ë¸” ë¶„ë‹´

### User Service ë‹´ë‹¹
- USERS
- FAV_STORE

### Store Service ë‹´ë‹¹
- STORES
- MENU
- REVIEW
- CATEGORY

### Reservation Service ë‹´ë‹¹
- BOOKING
- STORE_SEAT
- BOOKING_STATE_CODE

## ðŸ”§ Oracle PDB ì„¤ì •

### PDB ìƒì„± ë° ì„¤ì •
```sql
-- PDB ìƒì„±
CREATE PLUGGABLE DATABASE TEAMFOG
ADMIN USER teamfog_admin IDENTIFIED BY "admin_password_here"
STORAGE (MAXSIZE 2G)
DEFAULT TABLESPACE teamfog_data
DATAFILE '/opt/oracle/oradata/ORCL/TEAMFOG/teamfog_data01.dbf' SIZE 100M
AUTOEXTEND ON NEXT 10M MAXSIZE 1G;

-- PDB ì—´ê¸°
ALTER PLUGGABLE DATABASE TEAMFOG OPEN;

-- PDBë¡œ ì „í™˜
ALTER SESSION SET CONTAINER = TEAMFOG;
```

### ì„œë¹„ìŠ¤ë³„ ì‚¬ìš©ìž ìƒì„±
```sql
-- User Service ì‚¬ìš©ìž
CREATE USER user_service IDENTIFIED BY "user_password_here";
GRANT CONNECT, RESOURCE TO user_service;
GRANT CREATE SESSION TO user_service;
GRANT CREATE TABLE TO user_service;
GRANT CREATE VIEW TO user_service;
GRANT CREATE SEQUENCE TO user_service;

-- Store Service ì‚¬ìš©ìž
CREATE USER store_service IDENTIFIED BY "store_password_here";
GRANT CONNECT, RESOURCE TO store_service;
GRANT CREATE SESSION TO store_service;
GRANT CREATE TABLE TO store_service;
GRANT CREATE VIEW TO store_service;
GRANT CREATE SEQUENCE TO store_service;

-- Reservation Service ì‚¬ìš©ìž
CREATE USER reservation_service IDENTIFIED BY "reservation_password_here";
GRANT CONNECT, RESOURCE TO reservation_service;
GRANT CREATE SESSION TO reservation_service;
GRANT CREATE TABLE TO reservation_service;
GRANT CREATE VIEW TO reservation_service;
GRANT CREATE SEQUENCE TO reservation_service;
```

## ðŸ“Š ë°ì´í„° íƒ€ìž… ë§¤í•‘

| Logical | Physical | Oracle Type | Java Type |
|---------|----------|-------------|-----------|
| ìœ ì €ID | USER_ID | VARCHAR2(15) | String |
| ìœ ì €ì´ë¦„ | USER_NAME | VARCHAR2(20) | String |
| í•¸ë“œí°ë²ˆí˜¸ | PHONE_NUMBER | VARCHAR2(20) | String |
| ì£¼ì†Œì§€ | USER_LOCATION | VARCHAR2(50) | String |
| ë¹„ë°€ë²ˆí˜¸ | PASSWORD | VARCHAR2(255) | String |
| ê°€ê²ŒID | STORE_ID | VARCHAR2(20) | String |
| ê°€ê²Œì´ë¦„ | STORE_NAME | VARCHAR2(100) | String |
| ê°€ê²Œì£¼ì†Œ | STORE_LOCATION | VARCHAR2(200) | String |
| ì˜ˆì•½ë²ˆí˜¸ | BOOKING_NUM | VARCHAR2(20) | String |
| ì˜ˆì•½ì¼ìž | BOOKING_DATE | DATE | LocalDate |
| ì¸ì›ìˆ˜ | COUNT | NUMBER | Integer |
| í‰ì  | SCORE | NUMBER(2,1) | Double |
| ê°€ê²© | PRICE | NUMBER | BigDecimal |

## ðŸš€ ë°°í¬ ì‹œ ì£¼ì˜ì‚¬í•­

1. **í…Œì´ë¸” ìƒì„± ìˆœì„œ**: ì™¸ëž˜í‚¤ ì œì•½ì¡°ê±´ì„ ê³ ë ¤í•˜ì—¬ ì˜¬ë°”ë¥¸ ìˆœì„œë¡œ ìƒì„±
2. **ì¸ë±ìŠ¤ ìƒì„±**: ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•´ ì ì ˆí•œ ì¸ë±ìŠ¤ ìƒì„±
3. **ê¶Œí•œ ì„¤ì •**: ê° ì„œë¹„ìŠ¤ë³„ë¡œ í•„ìš”í•œ ìµœì†Œ ê¶Œí•œë§Œ ë¶€ì—¬
4. **ë°ì´í„° ë°±ì—…**: ì •ê¸°ì ì¸ ë°ì´í„° ë°±ì—… ì„¤ì •
5. **ëª¨ë‹ˆí„°ë§**: í…Œì´ë¸” í¬ê¸° ë° ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ì„¤ì •
